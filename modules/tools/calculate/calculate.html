<div id="calculator-view">
    <style>
        /* [디자인 개선 CSS 시작] */
        
        /* 1. 전체 폰트 및 기본 레이아웃 */
        #calculator-view {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', 'Segoe UI', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
            color: #333;
            line-height: 1.5;
            background-color: #f8f9fa; /* 전체 배경을 아주 연한 회색으로 */
            padding: 20px;
        }

        .calc-container {
            background-color: #ffffff !important;
            max-width: 1400px; /* 기존 1000px에서 1400px로 확장 */
            width: 95%; /* 모바일 등 작은 화면에서도 꽉 차게 */
            margin: 0 auto;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05); /* 부드러운 그림자 */
        }

        /* 2. 타이틀 스타일 */
        #calculator-view h1 {
            font-size: 28px; /* 제목 크기 확대 */
            font-weight: 700;
            color: #1a202c;
            border-bottom: 2px solid #3182ce;
            padding-bottom: 20px;
            margin-bottom: 40px;
            text-align: center;
        }

        #calculator-view h2 {
            font-size: 22px; /* 소제목 크기 확대 */
            font-weight: 600;
            color: #2d3748;
            margin-top: 40px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-left: 5px solid #3182ce;
            padding-left: 15px;
        }

        /* 3. 테이블 스타일 - 엑셀 느낌 제거하고 모던하게 */
        .overflow-x-auto {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        #calculator-view table {
            width: 100%;
            border-collapse: collapse !important;
            background-color: white;
            font-size: 16px; /* 표 글자 크기 확대 (14px -> 16px) */
        }

        #calculator-view th, 
        #calculator-view td {
            border: 1px solid #e2e8f0 !important; /* 연한 회색 테두리 */
            padding: 14px 16px; /* 셀 내부 여백 확대 */
            vertical-align: middle;
        }

        /* 테이블 헤더 */
        #calculator-view th {
            background-color: #f1f5f9; /* 연한 블루그레이 배경 */
            color: #475569;
            font-weight: 600;
            text-align: center;
            white-space: nowrap;
        }
        
        /* 섹션 헤더 (좌측 구분) */
        #calculator-view .section-header {
            background-color: #e2e8f0;
            color: #2d3748;
            font-size: 17px;
        }

        /* 4. 입력 필드 (Input) 스타일 개선 */
        #calculator-view input {
            width: 100%;
            padding: 12px; /* 입력창 내부 여백 확대 */
            border: 1px solid #cbd5e0 !important;
            border-radius: 6px;
            font-size: 16px; /* 입력 글자 크기 확대 */
            text-align: right; /* 숫자는 우측 정렬 */
            transition: all 0.2s ease;
            box-sizing: border-box;
            background-color: #fffbf0 !important; /* 아주 연한 아이보리 (입력가능 표시) */
            color: #2d3748;
            font-weight: 500;
            height: 45px; /* 입력창 높이 고정으로 터치/클릭 용이하게 */
        }

        /* 텍스트 입력 칸은 가운데 정렬 */
        #calculator-view input[type="text"]:not([inputmode="numeric"]):not(.readonly) {
             text-align: center;
        }

        /* 입력창 포커스 효과 */
        #calculator-view input:focus {
            border-color: #3182ce !important;
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
            background-color: #fff !important;
            outline: none;
        }

        /* 5. 읽기 전용 (Readonly) 스타일 */
        #calculator-view input:read-only,
        #calculator-view input.readonly {
            background-color: #f8fafc !important; /* 아주 연한 회색 */
            color: #718096;
            border: 1px solid #edf2f7 !important;
            cursor: default;
            font-weight: 600;
            box-shadow: none;
        }

        /* 6. 강조 행 및 결과 값 */
        .highlight-row td {
            background-color: #fff;
        }

        /* 결과값 텍스트 강조 */
        #calculator-view input[id^="display"],
        #calculator-view input[id^="profit"] {
            font-weight: 700;
            font-size: 18px; /* 결과값은 더 크게 */
        }
        
        #profit_monthly, #profit_total {
            color: #2b6cb0; /* 파란색 강조 */
        }

        #profit_cost_total {
            color: #c53030 !important; /* 붉은색 강조 */
        }

        /* 7. 기타 UI 요소 */
        .text-xs {
            font-size: 14px; /* 안내 문구도 약간 키움 */
            color: #718096;
            margin-bottom: 8px;
        }

        .info-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px; /* 아이콘 크기 확대 */
            height: 24px;
            background-color: #cbd5e0;
            color: white;
            border-radius: 50%;
            font-size: 14px;
            cursor: pointer;
            margin-left: 8px;
        }
        
        .info-icon:hover {
            background-color: #718096;
        }

        /* PDF 버튼 스타일 보강 (기존 클래스 유지하되 스타일 추가) */
        button[onclick="Calculator.saveAsPDF()"] {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            border: none;
            padding: 15px 40px; /* 버튼 크기 확대 */
            font-size: 18px; /* 버튼 글자 확대 */
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(229, 62, 62, 0.3);
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        button[onclick="Calculator.saveAsPDF()"]:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(229, 62, 62, 0.4);
        }

        /* 모달 스타일 (기존 유지 + 깔끔하게) */
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            max-width: 500px; /* 모달 너비 확대 */
            width: 90%;
            position: relative;
        }
        
        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 28px;
            cursor: pointer;
            color: #a0aec0;
        }
        
        .close-btn:hover { color: #4a5568; }

        /* [디자인 개선 CSS 끝] */
    </style>

    
    <div class="calc-container" id="calculator-content">
        <h1>복합기 렌탈 원가 계산서</h1>

        <!-- 1. 임대조건 및 예상 출력량 -->
        <h2>1. 임대조건 및 예상 출력량 <span class="info-icon" onclick="Calculator.openInfoModal(1)" data-html2canvas-ignore="true">i</span></h2>
        <div class="overflow-x-auto mb-4">
            <table>
                <colgroup>
                    <col style="width: 20%">
                    <col style="width: 20%">
                    <col style="width: 15%">
                    <col style="width: 20%">
                    <col style="width: 25%">
                </colgroup>
                <tr>
                    <th>기종명</th>
                    <th>기계원가</th>
                    <th>임대기간 (개월)</th>
                    <th>기계 감가상각 (월)</th>
                    <th>연 금리 (%)</th>
                </tr>
                <tr>
                    <td><input type="text" id="modelName" value="D3375CFPS"></td>
                    <td><input type="text" inputmode="numeric" id="machineCost" value="2,850,000" oninput="Calculator.handleInput(this)"></td>
                    <td><input type="text" inputmode="numeric" id="term" value="36" oninput="Calculator.handleInput(this)"></td>
                    <td><input type="text" id="monthlyDepreciation" class="readonly" readonly></td>
                    <td><input type="text" inputmode="decimal" id="interestRate" value="0" oninput="Calculator.handleInput(this)"></td>
                </tr>
            </table>
        </div>

        <div class="overflow-x-auto mb-4">
            <table>
                    <colgroup>
                    <col style="width: 15%">
                    <col style="width: 15%">
                    <col style="width: 20%">
                    <col style="width: 25%">
                    <col style="width: 25%">
                </colgroup>
                <tr>
                    <th rowspan="2" class="section-header">임대계약</th>
                    <th class="sub-header">구분</th>
                    <th class="sub-header">기본요금 (월)</th>
                    <th class="sub-header">예상 출력량 (월)</th>
                    <th class="sub-header">총 출력량 (계약기간)</th>
                </tr>
                <tr>
                    <td>금액 설정</td>
                    <td><input type="text" inputmode="numeric" id="rentalFee" value="100,000" oninput="Calculator.handleInput(this)"></td>
                    <td>흑백: <input type="text" inputmode="numeric" id="monthlyBW" value="1,000" style="width: calc(100% - 50px); display: inline-block;" oninput="Calculator.handleInput(this)"></td>
                    <td><input type="text" id="totalBW" class="readonly" readonly></td>
                </tr>
                <tr>
                    <th rowspan="2" class="section-header">기본제공</th>
                    <td>흑백매수</td>
                    <td><input type="text" inputmode="numeric" id="basicBW" value="1,000" oninput="Calculator.handleInput(this)"></td>
                    <td>칼라: <input type="text" inputmode="numeric" id="monthlyColor" value="100" style="width: calc(100% - 50px); display: inline-block;" oninput="Calculator.handleInput(this)"></td>
                    <td><input type="text" id="totalColor" class="readonly" readonly></td>
                </tr>
                <tr>
                    <td>칼라매수</td>
                    <td><input type="text" inputmode="numeric" id="basicColor" value="100" oninput="Calculator.handleInput(this)"></td>
                    <td rowspan="2" style="vertical-align: middle; background-color: #f8fafc; font-weight:bold; text-align:center;">총 합계 (흑+칼)</td>
                    <td rowspan="2" style="vertical-align: middle;">
                        <input type="text" id="totalOutputAll" class="readonly" style="font-weight:bold;" readonly>
                    </td>
                </tr>
                <tr>
                    <th rowspan="3" class="section-header">추가요금<br>(장당)</th>
                    <td>흑백</td>
                    <td><input type="text" inputmode="numeric" id="addFeeBW" value="10" oninput="Calculator.handleInput(this)"></td>
                </tr>
                <tr class="highlight-row">
                    <td>칼라 (A4)</td>
                    <td><input type="text" inputmode="numeric" id="addFeeColorA4" value="100" oninput="Calculator.handleInput(this)"></td>
                    <td style="font-weight:bold; color:#2b6cb0; text-align:center;">임대요금 (매월)</td>
                    <td><input type="text" id="displayMonthlyFee" class="readonly" style="font-weight:bold; color:#2b6cb0;" readonly></td>
                </tr>
                <tr class="highlight-row">
                    <td>칼라 (A3)</td>
                    <td><input type="text" inputmode="numeric" id="addFeeColorA3" value="200" oninput="Calculator.handleInput(this)"></td>
                    <td style="font-weight:bold; color:#2d3748; text-align:center;">임대요금 (총액)</td>
                    <td><input type="text" id="displayTotalFee" class="readonly" style="font-weight:bold; color:#2d3748;" readonly></td>
                </tr>
            </table>
        </div>

        <!-- 2. 소요비용 -->
        <h2>2. 소요비용 (소모품) <span class="info-icon" onclick="Calculator.openInfoModal(2)" data-html2canvas-ignore="true">i</span></h2>
        <div class="text-xs text-right mb-1">* 개수(x)를 조정하면 단가(세트 가격)가 자동으로 변경됩니다.</div>
        <div class="overflow-x-auto mb-4">
            <table>
                <colgroup>
                    <col style="width: 12%">
                    <col style="width: 18%">
                    <col style="width: 12%">
                    <col style="width: 15%">
                    <col style="width: 10%">
                    <col style="width: 13%">
                    <col style="width: 20%">
                </colgroup>
                <tr>
                    <th>구분</th>
                    <th>소모품명</th>
                    <th>수명 (Life)</th>
                    <th>단가</th>
                    <th>개수(x)</th>
                    <th>교환횟수</th>
                    <th>소요금액 (총)</th>
                </tr>
                <!-- 소모품 행들은 JS에서 초기화 시 값 설정됨 -->
                <tr><td rowspan="5" style="vertical-align: middle; text-align:center;">소모품</td><td>드럼 (K/C/M/Y)</td><td><input type="text" inputmode="numeric" id="life_drumCommon" value="143,000" oninput="Calculator.handleInput(this)"></td><td><input type="text" inputmode="numeric" id="cost_drumCommon" value="151,000" oninput="Calculator.handleInput(this)"></td><td><input type="number" id="qty_drumCommon" value="4" min="1" oninput="Calculator.handleInput(this)"></td><td><input type="text" id="count_drumCommon" class="readonly" readonly></td><td><input type="text" id="total_drumCommon" class="readonly" readonly></td></tr>
                <tr><td>토너 B</td><td><input type="text" inputmode="numeric" id="life_tonerB" value="26,000" oninput="Calculator.handleInput(this)"></td><td><input type="text" inputmode="numeric" id="cost_tonerB" value="82,000" oninput="Calculator.handleInput(this)"></td><td><input type="number" id="qty_tonerB" value="1" min="1" oninput="Calculator.handleInput(this)"></td><td><input type="text" id="count_tonerB" class="readonly" readonly></td><td><input type="text" id="total_tonerB" class="readonly" readonly></td></tr>
                <tr><td>토너 C/M/Y</td><td><input type="text" inputmode="numeric" id="life_tonerColor" value="15,000" oninput="Calculator.handleInput(this)"></td><td><input type="text" inputmode="numeric" id="cost_tonerColor" value="133,000" oninput="Calculator.handleInput(this)"></td><td><input type="number" id="qty_tonerColor" value="3" min="1" oninput="Calculator.handleInput(this)"></td><td><input type="text" id="count_tonerColor" class="readonly" readonly></td><td><input type="text" id="total_tonerColor" class="readonly" readonly></td></tr>
                <tr><td>폐토너통</td><td><input type="text" inputmode="numeric" id="life_waste" value="46,000" oninput="Calculator.handleInput(this)"></td><td><input type="text" inputmode="numeric" id="cost_waste" value="38,000" oninput="Calculator.handleInput(this)"></td><td><input type="number" id="qty_waste" value="1" min="1" oninput="Calculator.handleInput(this)"></td><td><input type="text" id="count_waste" class="readonly" readonly></td><td><input type="text" id="total_waste" class="readonly" readonly></td></tr>
                <tr><td>Fuser</td><td><input type="text" inputmode="numeric" id="life_fuser" value="100,000" oninput="Calculator.handleInput(this)"></td><td><input type="text" inputmode="numeric" id="cost_fuser" value="250,000" oninput="Calculator.handleInput(this)"></td><td><input type="number" id="qty_fuser" value="1" min="1" oninput="Calculator.handleInput(this)"></td><td><input type="text" id="count_fuser" class="readonly" readonly></td><td><input type="text" id="total_fuser" class="readonly" readonly></td></tr>
                <tr class="result-row"><td colspan="6" style="text-align:center; font-weight:bold; background-color:#f1f5f9;">소모품 총 소요금액 합계</td><td><input type="text" id="grandTotalConsumables" class="readonly" style="text-align: center; font-size: 1.1em; background-color:#f1f5f9 !important;" readonly></td></tr>
            </table>
        </div>

        <!-- 3. 임대시 이익 -->
        <h2>3. 임대시 이익 (월) <span class="info-icon" onclick="Calculator.openInfoModal(3)" data-html2canvas-ignore="true">i</span></h2>
        <div class="overflow-x-auto mb-4">
            <table>
                <tr><th>구분</th><th>기계 감가 (월)</th><th>금리비용 (월)</th><th>소모품 비용 (월)</th><th>원가 합계 (월)</th><th>임대 요금 (월)</th><th>이익 (월)</th><th>마진율 (%)</th><th>총 이익 (전체)</th></tr>
                <tr><td>금액</td><td><input type="text" id="profit_machine" class="readonly" readonly></td><td><input type="text" id="profit_interest" class="readonly" readonly></td><td><input type="text" id="profit_consumable" class="readonly" readonly></td><td><input type="text" id="profit_cost_total" class="readonly" style="color: #d35400;" readonly></td><td><input type="text" id="profit_rental_fee" class="readonly" readonly></td><td><input type="text" id="profit_monthly" class="readonly" style="font-weight:bold;" readonly></td><td><input type="text" id="profit_margin_rate" class="readonly" style="font-weight:bold; text-align:center;" readonly></td><td><input type="text" id="profit_total" class="readonly" style="font-weight:bold;" readonly></td></tr>
            </table>
        </div>

        <!-- PDF 저장 버튼 -->
        <div class="text-center mt-8 mb-4" data-html2canvas-ignore="true" style="text-align:center; margin-top: 2rem;">
            <button onclick="Calculator.saveAsPDF()" class="bg-red-500 text-white px-6 py-3 rounded-lg font-bold shadow-md hover:bg-red-600 transition-colors flex items-center justify-center gap-2 mx-auto">
                <i class="fa-solid fa-file-pdf"></i> 견적서 PDF로 저장
            </button>
        </div>
    </div>

    <!-- 설명 모달 -->
    <div id="infoModal" class="fixed inset-0 z-50 hidden flex items-center justify-center">
        <div class="modal-content relative">
            <span class="close-btn" onclick="Calculator.closeInfoModal()">&times;</span>
            <div id="modalHeader" class="text-lg font-bold text-slate-800 mb-2 pb-2 border-b border-blue-500"></div>
            <div id="modalBody" class="text-sm text-gray-700 leading-relaxed"></div>
        </div>
    </div>
</div>